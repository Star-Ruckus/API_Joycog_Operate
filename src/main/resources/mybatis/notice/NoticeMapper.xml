<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.joycog.operate.api.notice.repository.NoticeRepository">
    <insert id="insertNotice">
        /**
          * NoticeMapper.xml
          * id = insertNotice
          * 공지사항 등록
        */
        INSERT INTO tb_notice_list (notice_set,
                                    notice_type,
                                    notice_title,
                                    notice_content,
                                    language_code,
                                    use_yn,
                                    star_date,
                                    end_date,
                                    use_platform,
                                    image_url
        ) VALUES (#{noticeSet},
                  #{noticeType},
                  #{noticeTitle},
                  #{noticeContent},
                  #{languageCode},
                  #{useYn},
                  #{startDate},
                  #{endDate},
                  #{usePlatform},
                  #{imangeUrl}
        )
    </insert>

    <update id="updateNotice">
        /**
        * NoticeMapper.xml
        * id = updateNotice
        * 공지사항 수정
        */
        UPDATE tb_notice_list
        <set>
            <if test="noticeType != null">notice_type = #{noticeType},</if>
            <if test="noticeTitle != null">notice_title = #{noticeTitle},</if>
            <if test="noticeContent != null">notice_content = #{noticeContent},</if>
            <if test="languageCode != null">language_code = #{languageCode},</if>
            <if test="useYn != null">use_yn = #{useYn},</if>
            <if test="startDate != null">start_date = #{startDate},</if>
            <if test="endDate != null">end_date = #{endDate},</if>
            <if test="usePlatform != null">use_platform = #{usePlatform},</if>
            <if test="imageUrl != null">image_url = #{imageUrl},</if>
        </set>
        <where>
            <if test="noticeId != null">AND notice_id = #{noticeId}</if>
            <if test="noticeSet != null">AND notice_set = #{noticeSet}</if>
        </where>
    </update>

    <select id="getMaxNoticeSet" resultType="int">
        /**
        * NoticeMapper.xml
        * id = getMaxNoticeSet
        * 공지사항 마지막 notice_set 구하기
        */
        SELECT IFNULL(MAX(notice_set)+1 , 1) as maxNoticeSet
        FROM tb_notice_list
    </select>
</mapper>